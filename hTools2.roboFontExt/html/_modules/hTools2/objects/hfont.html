<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>hTools2.objects.hfont &mdash; hTools2</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <link rel="top" title="hTools2" href="../../../index.html" />
    <link rel="up" title="hTools2" href="../../hTools2.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">hTools2</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../hTools2.html" accesskey="U">hTools2</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for hTools2.objects.hfont</h1><div class="highlight"><pre>
<span class="c"># [h] hFont</span>

<span class="c"># import</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">hproject</span> <span class="kn">import</span> <span class="n">hProject</span>

<span class="kn">from</span> <span class="nn">hTools2.modules.anchors</span> <span class="kn">import</span> <span class="n">clear_anchors</span><span class="p">,</span> <span class="n">get_anchors_dict</span>
<span class="kn">from</span> <span class="nn">hTools2.modules.color</span> <span class="kn">import</span> <span class="n">clear_colors</span><span class="p">,</span> <span class="n">hls_to_rgb</span>
<span class="kn">from</span> <span class="nn">hTools2.modules.encoding</span> <span class="kn">import</span> <span class="n">paint_groups</span><span class="p">,</span> <span class="n">auto_unicodes</span><span class="p">,</span> <span class="n">crop_glyphset</span>
<span class="kn">from</span> <span class="nn">hTools2.modules.fontinfo</span> <span class="kn">import</span> <span class="n">set_names_from_path</span><span class="p">,</span> <span class="n">set_vmetrics</span><span class="p">,</span> <span class="n">get_stems</span><span class="p">,</span> <span class="n">set_stems</span>
<span class="kn">from</span> <span class="nn">hTools2.modules.fontutils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">hTools2.modules.ftp</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">hTools2.modules.opentype</span> <span class="kn">import</span> <span class="n">import_features</span><span class="p">,</span> <span class="n">clear_features</span><span class="p">,</span> <span class="n">import_kern_feature</span>

<span class="kn">from</span> <span class="nn">fontTools.ttLib</span> <span class="kn">import</span> <span class="n">TTFont</span>

<span class="c"># functions</span>

<div class="viewcode-block" id="strip_names"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.strip_names">[docs]</a><span class="k">def</span> <span class="nf">strip_names</span><span class="p">(</span><span class="n">ttx_path</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">hTools2.extras.ElementTree</span> <span class="kn">as</span> <span class="nn">ET</span>
    <span class="c"># nameIDs which will be erased</span>
    <span class="n">nameIDs</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span> <span class="p">]</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">ttx_path</span><span class="p">)</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s">&#39;nameID&#39;</span><span class="p">])</span> <span class="ow">in</span> <span class="n">nameIDs</span><span class="p">:</span>
            <span class="n">child</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">&#39; &#39;</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ttx_path</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ttx2otf"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.ttx2otf">[docs]</a><span class="k">def</span> <span class="nf">ttx2otf</span><span class="p">(</span><span class="n">ttx_path</span><span class="p">,</span> <span class="n">otf_path</span><span class="p">):</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">TTFont</span><span class="p">()</span>
    <span class="n">tt</span><span class="o">.</span><span class="n">importXML</span><span class="p">(</span><span class="n">ttx_path</span><span class="p">)</span>
    <span class="n">tt</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">otf_path</span><span class="p">)</span>

<span class="c"># objects</span>
</div>
<div class="viewcode-block" id="hFont"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont">[docs]</a><span class="k">class</span> <span class="nc">hFont</span><span class="p">:</span>

    <span class="sd">&#39;&#39;&#39;An object to represent a ``.ufo`` font source, wrapped in a few useful functions.&#39;&#39;&#39;</span>

    <span class="c"># attributes</span>

    <span class="c">#: The parent ``hProject`` object to which the font belongs.</span>
    <span class="n">project</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c">#: The ``.ufo`` file containing the actual font.</span>
    <span class="n">ufo</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c">#: The name of the ``.ufo`` file, without the extension.</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c">#: The ``styleName`` of the font, parsed from the name of the ``.ufo`` file on initialization. See ``init_from_filename()``.</span>
    <span class="n">style_name</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c">#: A dictionary with the parameters which identify this particular font in the family&#39;s variation space.</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c">#: A dictionary to contain this font&#39;s guidelines, once the basic vertical metrics have been defined and set.</span>
    <span class="n">guides_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c"># methods</span>

<div class="viewcode-block" id="hFont.__init__"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ufo</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Initiate the ``hFont`` object from a ``.ufo`` file.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span> <span class="o">=</span> <span class="n">ufo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_from_filename</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="hFont.__repr__"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.__repr__">[docs]</a>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Return textual representation of ``hFont``.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="s">&#39;&lt;hFont </span><span class="si">%s</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_name</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="hFont.init_from_filename"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.init_from_filename">[docs]</a>    <span class="k">def</span> <span class="nf">init_from_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set_names</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Initiate ``hFont`` object from ``RFont``, get parent project, parse name parts.&#39;&#39;&#39;</span>
        <span class="n">ufo_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">ufo_file</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c"># break file name into family- and style name</span>
            <span class="n">family_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span>
            <span class="c"># get parent project</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">hProject</span><span class="p">(</span><span class="n">family_name</span><span class="p">)</span>
            <span class="c"># set font names</span>
            <span class="k">if</span> <span class="n">set_names</span><span class="p">:</span>
                <span class="n">set_font_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="n">family_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_name</span><span class="p">)</span>
            <span class="c"># get parameters from name and store them into a dict</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">name_parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">)</span>
                <span class="n">parameters_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;project&#39;</span><span class="p">][</span><span class="s">&#39;parameters_order&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">parameters_order</span><span class="p">,</span> <span class="n">name_parameters</span><span class="p">))</span>
            <span class="c"># keep parameters dict empty</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="c"># print &#39;Error: no parameters lib for this font.\n&#39;</span>
                <span class="k">pass</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;Error: font name is not in the format family_style&#39;</span>

    <span class="c"># groups and glyphs</span>
</div>
<div class="viewcode-block" id="hFont.create_glyphs"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.create_glyphs">[docs]</a>    <span class="k">def</span> <span class="nf">create_glyphs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Create all glyphs from the project&#39;s encoding file.&#39;&#39;&#39;</span>
        <span class="n">glyph_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">glyphset</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">glyph_name</span> <span class="ow">in</span> <span class="n">glyph_set</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">newGlyph</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="hFont.glyphset"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.glyphset">[docs]</a>    <span class="k">def</span> <span class="nf">glyphset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Return a list with all glyph names in the font&#39;s glyphset.&#39;&#39;&#39;</span>
        <span class="n">_glyph_order</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;groups&#39;</span><span class="p">][</span><span class="s">&#39;order&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;groups&#39;</span><span class="p">][</span><span class="s">&#39;glyphs&#39;</span><span class="p">][</span><span class="n">group</span><span class="p">]:</span>
                <span class="n">_glyph_order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">glyph</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_glyph_order</span>
</div>
<div class="viewcode-block" id="hFont.auto_unicodes"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.auto_unicodes">[docs]</a>    <span class="k">def</span> <span class="nf">auto_unicodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Automatically set unicodes for all glyphs in the font.&#39;&#39;&#39;</span>
        <span class="n">auto_unicodes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.clear_groups"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.clear_groups">[docs]</a>    <span class="k">def</span> <span class="nf">clear_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Delete all groups in the font.&#39;&#39;&#39;</span>
        <span class="n">delete_groups</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.order_glyphs"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.order_glyphs">[docs]</a>    <span class="k">def</span> <span class="nf">order_glyphs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Automatically set the order of the glyphs in the font based on the project&#39;s ``groups`` lib.&#39;&#39;&#39;</span>
        <span class="n">glyph_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">glyphset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">glyphOrder</span> <span class="o">=</span> <span class="n">glyph_order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="hFont.paint_groups"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.paint_groups">[docs]</a>    <span class="k">def</span> <span class="nf">paint_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crop</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Paints and orders the glyphs in the font based on the project&#39;s ``groups`` lib.&#39;&#39;&#39;</span>
        <span class="n">paint_groups</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="n">crop</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.import_spacing_groups"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.import_spacing_groups">[docs]</a>    <span class="k">def</span> <span class="nf">import_spacing_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Import left/right spacing classes from lib into groups.&#39;&#39;&#39;</span>
        <span class="n">_spacing_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;spacing&#39;</span><span class="p">]</span>
        <span class="c"># old hTools1 format</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">side</span> <span class="ow">in</span> <span class="n">_spacing_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">_spacing_dict</span><span class="p">[</span><span class="n">side</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">_class_name</span> <span class="o">=</span> <span class="s">&#39;_</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">side</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
                    <span class="n">_glyphs</span> <span class="o">=</span> <span class="p">[</span> <span class="n">group</span> <span class="p">]</span> <span class="o">+</span> <span class="n">_spacing_dict</span><span class="p">[</span><span class="n">side</span><span class="p">][</span><span class="n">group</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">_class_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_glyphs</span>
        <span class="c"># new hTools2 format</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">side</span> <span class="ow">in</span> <span class="n">_spacing_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">_spacing_dict</span><span class="p">[</span><span class="n">side</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="n">_spacing_dict</span><span class="p">[</span><span class="n">side</span><span class="p">][</span><span class="n">group</span><span class="p">]</span>
        <span class="c"># update font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="hFont.paint_spacing_groups"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.paint_spacing_groups">[docs]</a>    <span class="k">def</span> <span class="nf">paint_spacing_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">side</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Paint left or right spacing groups.&#39;&#39;&#39;</span>
        <span class="c"># collect groups &amp; glyphs to paint</span>
        <span class="n">_groups_dict</span> <span class="o">=</span> <span class="n">get_spacing_groups</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">side</span> <span class="o">==</span> <span class="s">&#39;left&#39;</span><span class="p">:</span>
            <span class="n">_groups</span> <span class="o">=</span> <span class="n">_groups_dict</span><span class="p">[</span><span class="s">&#39;left&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_groups</span> <span class="o">=</span> <span class="n">_groups_dict</span><span class="p">[</span><span class="s">&#39;right&#39;</span><span class="p">]</span>
        <span class="c"># paint</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_groups</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;painting spacing groups...&#39;</span>
            <span class="k">print</span>
            <span class="n">_group_names</span> <span class="o">=</span> <span class="n">_groups</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="n">clear_colors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
            <span class="n">color_step</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">_group_names</span><span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">_group_names</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">painting group </span><span class="si">%s</span><span class="s">...&#39;</span> <span class="o">%</span> <span class="n">group</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">color_step</span> <span class="o">*</span> <span class="n">count</span>
                <span class="n">R</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">hls_to_rgb</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">glyph_name</span> <span class="ow">in</span> <span class="n">_groups</span><span class="p">[</span><span class="n">group</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">[</span><span class="n">glyph_name</span><span class="p">]</span><span class="o">.</span><span class="n">mark</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">[</span><span class="n">glyph_name</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                            <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t\t</span><span class="si">%s</span><span class="s"> not in font&#39;</span> <span class="o">%</span> <span class="n">glyph_name</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span>
                <span class="k">print</span> <span class="s">&#39;...done.</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;there are no spacing groups to paint.</span><span class="se">\n</span><span class="s">&#39;</span>
</div>
<div class="viewcode-block" id="hFont.import_groups_from_encoding"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.import_groups_from_encoding">[docs]</a>    <span class="k">def</span> <span class="nf">import_groups_from_encoding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Import glyph names and order from encoding file, and stores them in a lib.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">import_encoding</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;groups&#39;</span><span class="p">][</span><span class="s">&#39;glyphs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;groups&#39;</span><span class="p">][</span><span class="s">&#39;glyphs&#39;</span><span class="p">][</span><span class="n">group</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">lib</span><span class="p">[</span><span class="s">&#39;groups_order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;groups&#39;</span><span class="p">][</span><span class="s">&#39;order&#39;</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="hFont.crop_glyphset"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.crop_glyphset">[docs]</a>    <span class="k">def</span> <span class="nf">crop_glyphset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Delete all glyphs which are not in the font&#39;s glyphset.&#39;&#39;&#39;</span>
        <span class="n">glyph_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">glyphset</span><span class="p">()</span>
        <span class="n">crop_glyphset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="n">glyph_set</span><span class="p">)</span>

    <span class="c"># actions</span>
</div>
<div class="viewcode-block" id="hFont.apply_actions"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.apply_actions">[docs]</a>    <span class="k">def</span> <span class="nf">apply_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions_dict</span><span class="p">):</span>
        <span class="c"># if actions_dict[&#39;remove overlap&#39;]:</span>
        <span class="c">#     self.remove_overlap()</span>
        <span class="c"># if actions_dict[&#39;decompose&#39;]:</span>
        <span class="c">#     self.decompose()</span>
        <span class="c"># if actions_dict[&#39;auto contour order&#39;]:</span>
        <span class="c">#     self.auto_contour_order()</span>
        <span class="c"># if actions_dict[&#39;auto contour direction&#39;]:</span>
        <span class="c">#     self.auto_contour_direction()</span>
        <span class="c"># if actions_dict[&#39;add extremes&#39;]:</span>
        <span class="c">#     self.add_extremes()</span>
        <span class="c"># if actions_dict[&#39;remove overlaps&#39;]:</span>
        <span class="c">#     self.remove_overlap()</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="hFont.remove_overlap"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.remove_overlap">[docs]</a>    <span class="k">def</span> <span class="nf">remove_overlap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Remove overlaps for all glyphs in font.&#39;&#39;&#39;</span>
        <span class="n">remove_overlap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.decompose"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.decompose">[docs]</a>    <span class="k">def</span> <span class="nf">decompose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Decompose all glyphs in font.&#39;&#39;&#39;</span>
        <span class="n">decompose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.auto_contour_order"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.auto_contour_order">[docs]</a>    <span class="k">def</span> <span class="nf">auto_contour_order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Auto set contour order in all glyphs in font.&#39;&#39;&#39;</span>
        <span class="n">auto_contour_order</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.auto_contour_direction"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.auto_contour_direction">[docs]</a>    <span class="k">def</span> <span class="nf">auto_contour_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Auto set contour direction in all glyphs in font.&#39;&#39;&#39;</span>
        <span class="n">auto_contour_direction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.auto_order_direction"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.auto_order_direction">[docs]</a>    <span class="k">def</span> <span class="nf">auto_order_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Auto set contour order and direction in all glyphs in font.&#39;&#39;&#39;</span>
        <span class="n">auto_order_direction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.add_extremes"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.add_extremes">[docs]</a>    <span class="k">def</span> <span class="nf">add_extremes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Auto add extreme points in all glyphs in font.&#39;&#39;&#39;</span>
        <span class="n">add_extremes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.align_to_grid"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.align_to_grid">[docs]</a>    <span class="k">def</span> <span class="nf">align_to_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">sizeX</span><span class="p">,</span> <span class="n">sizeY</span><span class="p">)):</span>
        <span class="sd">&#39;&#39;&#39;Align points in all glyphs in font to the given ``(x,y)`` grid.&#39;&#39;&#39;</span>
        <span class="n">align_to_grid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="p">(</span><span class="n">sizeX</span><span class="p">,</span> <span class="n">sizeY</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="hFont.scale_glyphs"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.scale_glyphs">[docs]</a>    <span class="k">def</span> <span class="nf">scale_glyphs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">factor_x</span><span class="p">,</span> <span class="n">factor_y</span><span class="p">)):</span>
        <span class="sd">&#39;&#39;&#39;Scale all glyphs in font by the given factor ``(x,y)``.&#39;&#39;&#39;</span>
        <span class="n">scale_glyphs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="p">(</span><span class="n">factor_x</span><span class="p">,</span> <span class="n">factor_y</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="hFont.move_glyphs"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.move_glyphs">[docs]</a>    <span class="k">def</span> <span class="nf">move_glyphs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">delta_x</span><span class="p">,</span> <span class="n">delta_y</span><span class="p">)):</span>
        <span class="sd">&#39;&#39;&#39;Move all glyphs in font by the given distance ``(x,y)``.&#39;&#39;&#39;</span>
        <span class="n">move_glyphs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="p">(</span><span class="n">delta_x</span><span class="p">,</span> <span class="n">delta_y</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="hFont.round_to_grid"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.round_to_grid">[docs]</a>    <span class="k">def</span> <span class="nf">round_to_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gridsize</span><span class="p">,</span> <span class="n">gstring</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Round points in all given glyphs in the font to the given ``gridsize``.&#39;&#39;&#39;</span>
        <span class="n">glyph_names</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">gstring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">names</span> <span class="o">=</span> <span class="n">gstring</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
            <span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;groups&#39;</span><span class="p">][</span><span class="s">&#39;glyphs&#39;</span><span class="p">]</span>
            <span class="n">glyph_names</span> <span class="o">=</span> <span class="n">parse_glyphs_groups</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>
        <span class="n">round_to_grid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="n">gridsize</span><span class="p">,</span> <span class="n">glyph_names</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.delete_layers"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.delete_layers">[docs]</a>    <span class="k">def</span> <span class="nf">delete_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Delete all layers in the font.&#39;&#39;&#39;</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">layerOrder</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">removeLayer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">layerOrder</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="c"># building glyphs</span>
</div>
<div class="viewcode-block" id="hFont.clear_anchors"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.clear_anchors">[docs]</a>    <span class="k">def</span> <span class="nf">clear_anchors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gstring</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Delete all anchors in the font.&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">gstring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">_glyph_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parse_gstring</span><span class="p">(</span><span class="n">gstring</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_glyph_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">all_glyphs</span><span class="p">()</span>
        <span class="n">clear_anchors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="n">glyph_names</span><span class="o">=</span><span class="n">_glyph_names</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.build_glyph"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.build_glyph">[docs]</a>    <span class="k">def</span> <span class="nf">build_glyph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glyph_name</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Build glyph with the given ``glyph_name`` from components based on the project&#39;s ``accents`` or ``composed`` libs.&#39;&#39;&#39;</span>
        <span class="c"># accents</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;accents&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">):</span>
            <span class="n">base_glyph</span><span class="p">,</span> <span class="n">accents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;accents&#39;</span><span class="p">][</span><span class="n">glyph_name</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">removeGlyph</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">compileGlyph</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">,</span> <span class="n">base_glyph</span><span class="p">,</span> <span class="n">accents</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">[</span><span class="n">glyph_name</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="c"># composed</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;composed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">newGlyph</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">components</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;composed&#39;</span><span class="p">][</span><span class="n">glyph_name</span><span class="p">]</span>
            <span class="n">_offset_x</span><span class="p">,</span> <span class="n">_offset_y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
            <span class="n">_scale_x</span><span class="p">,</span> <span class="n">_scale_y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">[</span><span class="n">glyph_name</span><span class="p">]</span><span class="o">.</span><span class="n">appendComponent</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="p">(</span><span class="n">_offset_x</span><span class="p">,</span> <span class="n">_offset_y</span><span class="p">),</span> <span class="p">(</span><span class="n">_scale_x</span><span class="p">,</span> <span class="n">_scale_y</span><span class="p">))</span>
                <span class="n">_offset_x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">[</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">width</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">[</span><span class="n">glyph_name</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="c"># not composed</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> is not composed.</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">glyph_name</span>
</div>
<div class="viewcode-block" id="hFont.build_accents"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.build_accents">[docs]</a>    <span class="k">def</span> <span class="nf">build_accents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Build all accented glyphs in the font based on the project&#39;s ``accents`` libs.&#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">glyph_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;accents&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">build_glyph</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.build_composed"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.build_composed">[docs]</a>    <span class="k">def</span> <span class="nf">build_composed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Build all composed glyphs in the font based on the project&#39;s ``composed`` libs.&#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">glyph_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;composed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">build_glyph</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.build_anchors"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.build_anchors">[docs]</a>    <span class="k">def</span> <span class="nf">build_anchors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="c"># get anchors</span>
        <span class="n">anchors_lib</span> <span class="o">=</span> <span class="n">get_anchors_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;accents&#39;</span><span class="p">])</span>
        <span class="n">vmetrics_lib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_vmetrics</span><span class="p">()</span>
        <span class="n">groups_lib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;groups&#39;</span><span class="p">][</span><span class="s">&#39;glyphs&#39;</span><span class="p">]</span>
        <span class="c"># clear anchors</span>
        <span class="k">if</span> <span class="n">clear</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clear_anchors</span><span class="p">()</span>
        <span class="c"># create base anchors</span>
        <span class="k">for</span> <span class="n">glyph_name</span> <span class="ow">in</span> <span class="n">anchors_lib</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">):</span>
                <span class="n">glyph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">[</span><span class="n">glyph_name</span><span class="p">]</span>
                <span class="c"># get horizontal center</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">box</span>
                    <span class="n">x_center</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="p">((</span><span class="n">r</span> <span class="o">-</span> <span class="n">l</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">x_center</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.5</span>
                <span class="c"># lc top base</span>
                <span class="k">if</span> <span class="s">&#39;top&#39;</span> <span class="ow">in</span> <span class="n">anchors_lib</span><span class="p">[</span><span class="n">glyph_name</span><span class="p">]:</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">vmetrics_lib</span><span class="p">[</span><span class="s">&#39;xheight&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">vmetrics_lib</span><span class="p">[</span><span class="s">&#39;xheight_anchors&#39;</span><span class="p">]</span>
                    <span class="n">glyph</span><span class="o">.</span><span class="n">appendAnchor</span><span class="p">(</span><span class="s">&#39;top&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">x_center</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
                <span class="c"># lc bottom base</span>
                <span class="k">if</span> <span class="s">&#39;bottom&#39;</span> <span class="ow">in</span> <span class="n">anchors_lib</span><span class="p">[</span><span class="n">glyph_name</span><span class="p">]:</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">vmetrics_lib</span><span class="p">[</span><span class="s">&#39;baseline_lc_anchors&#39;</span><span class="p">]</span>
                    <span class="n">glyph</span><span class="o">.</span><span class="n">appendAnchor</span><span class="p">(</span><span class="s">&#39;bottom&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">x_center</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
                <span class="c"># done glyph</span>
                <span class="n">glyph</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="c"># create accents anchors</span>
        <span class="k">for</span> <span class="n">glyph_name</span> <span class="ow">in</span> <span class="n">groups_lib</span><span class="p">[</span><span class="s">&#39;accents_lc&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">glyph_name</span><span class="p">):</span>
                <span class="n">glyph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">[</span><span class="n">glyph_name</span><span class="p">]</span>
                <span class="c"># get horizontal center</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">box</span>
                    <span class="n">x_center</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="p">((</span><span class="n">r</span> <span class="o">-</span> <span class="n">l</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">x_center</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.5</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">vmetrics_lib</span><span class="p">[</span><span class="s">&#39;xheight&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">vmetrics_lib</span><span class="p">[</span><span class="s">&#39;xheight_anchors&#39;</span><span class="p">]</span>
                <span class="n">glyph</span><span class="o">.</span><span class="n">appendAnchor</span><span class="p">(</span><span class="s">&#39;_top&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">x_center</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="c"># done font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="c"># OT features</span>
</div>
<div class="viewcode-block" id="hFont.clear_features"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.clear_features">[docs]</a>    <span class="k">def</span> <span class="nf">clear_features</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Delete all OpenType features and classes in font.&#39;&#39;&#39;</span>
        <span class="n">clear_features</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.import_features"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.import_features">[docs]</a>    <span class="k">def</span> <span class="nf">import_features</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Import features from features file into font.&#39;&#39;&#39;</span>
        <span class="n">import_features</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">paths</span><span class="p">[</span><span class="s">&#39;features&#39;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="hFont.import_kern_feature"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.import_kern_feature">[docs]</a>    <span class="k">def</span> <span class="nf">import_kern_feature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Import `kern` feature from features file into font.&#39;&#39;&#39;</span>
        <span class="c"># extend: make switch to get style-specific kerning</span>
        <span class="n">kern_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">paths</span><span class="p">[</span><span class="s">&#39;libs&#39;</span><span class="p">],</span> <span class="s">&#39;kern.fea&#39;</span><span class="p">)</span>
        <span class="n">import_kern_feature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="n">kern_path</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.export_features"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.export_features">[docs]</a>    <span class="k">def</span> <span class="nf">export_features</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Export features from font to features file.&#39;&#39;&#39;</span>
        <span class="n">export_features</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">paths</span><span class="p">[</span><span class="s">&#39;features&#39;</span><span class="p">])</span>

    <span class="c"># font names</span>
</div>
<div class="viewcode-block" id="hFont.full_name"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.full_name">[docs]</a>    <span class="k">def</span> <span class="nf">full_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Return the full name of the font, made of the `hProject.name` and `font.style_name`.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.set_names"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.set_names">[docs]</a>    <span class="k">def</span> <span class="nf">set_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Set font names from the font&#39;s ``.ufo`` file name.&#39;&#39;&#39;</span>
        <span class="n">set_names_from_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&#39;HPTP&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.name_from_parameters"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.name_from_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">name_from_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Set font names from the font&#39;s parameters lib.&#39;&#39;&#39;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;project&#39;</span><span class="p">][</span><span class="s">&#39;parameters_order&#39;</span><span class="p">]</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">parameter</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">name</span> <span class="o">+=</span> <span class="n">separator</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="c"># font info</span>
</div>
<div class="viewcode-block" id="hFont.set_info"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.set_info">[docs]</a>    <span class="k">def</span> <span class="nf">set_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Set font names from the ``.ufo``&#39;s path name.&#39;&#39;&#39;</span>
        <span class="n">set_names_from_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.set_foundry_info"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.set_foundry_info">[docs]</a>    <span class="k">def</span> <span class="nf">set_foundry_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Set foundry info from the project&#39;s ``info`` lib.&#39;&#39;&#39;</span>
        <span class="n">fontinfo_lib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;info&#39;</span><span class="p">]</span>
        <span class="c"># set info fields</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fontinfo_lib</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">fontinfo_lib</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;copyright&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">copyright</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;trademark&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">trademark</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;note&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">note</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;licence&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">openTypeNameLicense</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;sample&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">openTypeNameSampleText</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;description&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">openTypeNameDescription</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;year&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;designer&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">openTypeNameDesigner</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;designer_url&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">openTypeNameDesignerURL</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;manufacturer&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">openTypeNameManufacturer</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;manufacturer_url&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">openTypeNameManufacturerURL</span> <span class="o">=</span> <span class="n">v</span>
        <span class="c"># done</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="hFont.print_info"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.print_info">[docs]</a>    <span class="k">def</span> <span class="nf">print_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Print different kinds of font information.&#39;&#39;&#39;</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="hFont.clear_info"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.clear_info">[docs]</a>    <span class="k">def</span> <span class="nf">clear_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Print different kinds of font information.&#39;&#39;&#39;</span>
        <span class="n">clear_font_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>

    <span class="c"># vertical metrics</span>
</div>
<div class="viewcode-block" id="hFont.get_vmetrics"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.get_vmetrics">[docs]</a>    <span class="k">def</span> <span class="nf">get_vmetrics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Build a ``vmetrics`` dict using data from the ``vmetrics`` lib.&#39;&#39;&#39;</span>
        <span class="c"># build up vmetrics dict</span>
        <span class="n">vmetrics_lib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;project&#39;</span><span class="p">][</span><span class="s">&#39;vmetrics&#39;</span><span class="p">]</span>
        <span class="n">vmetrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c"># get default values</span>
        <span class="k">if</span> <span class="n">vmetrics_lib</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&#39;default&#39;</span><span class="p">):</span>
            <span class="n">vmetrics</span> <span class="o">=</span> <span class="n">vmetrics_lib</span><span class="p">[</span><span class="s">&#39;default&#39;</span><span class="p">]</span>
        <span class="c"># get style-specific values</span>
        <span class="k">if</span> <span class="n">vmetrics_lib</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style_name</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vmetrics_lib</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">style_name</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">vmetrics</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmetrics_lib</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">style_name</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
        <span class="c"># condensed: get values from normal</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">style</span> <span class="ow">in</span> <span class="n">vmetrics_lib</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">style</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">style_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vmetrics_lib</span><span class="p">[</span><span class="n">style</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">vmetrics</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmetrics_lib</span><span class="p">[</span><span class="n">style</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">vmetrics</span>

    <span class="c"># def get_stems(self):</span>
    <span class="c">#     # build up vmetrics dict</span>
    <span class="c">#     stems_lib = self.project.libs[&#39;project&#39;][&#39;stems&#39;]</span>
    <span class="c">#     stems = []</span>
    <span class="c">#     # get default values</span>
    <span class="c">#     if stems_lib.has_key(&#39;default&#39;):</span>
    <span class="c">#         stems = stems_lib[&#39;default&#39;]</span>
    <span class="c">#     # get style-specific values</span>
    <span class="c">#     if stems_lib.has_key(self.style_name):</span>
    <span class="c">#         stems = stems_lib[self.style_name]</span>
    <span class="c">#     # condensed: get values from normal</span>
    <span class="c">#     else:</span>
    <span class="c">#         for style in stems_lib.keys():</span>
    <span class="c">#             if style[0] == self.style_name[0]:</span>
    <span class="c">#                 stems = stems_lib[style]</span>
    <span class="c">#     return stems</span>
</div>
<div class="viewcode-block" id="hFont.set_stems"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.set_stems">[docs]</a>    <span class="k">def</span> <span class="nf">set_stems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Set PS stems by measuring glyph data in the font.&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;setting stems in </span><span class="si">%s</span><span class="s">...&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_name</span><span class="p">(),</span>
        <span class="n">stems</span> <span class="o">=</span> <span class="n">get_stems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
        <span class="n">set_stems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="n">stems</span><span class="p">)</span>
        <span class="c"># done</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;done.&#39;</span>
</div>
<div class="viewcode-block" id="hFont.set_vmetrics"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.set_vmetrics">[docs]</a>    <span class="k">def</span> <span class="nf">set_vmetrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Set the font&#39;s vertical metrics from the a ``vmetrics`` dict.&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;setting vertical metrics in </span><span class="si">%s</span><span class="s">...&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_name</span><span class="p">(),</span>
        <span class="c"># set vmetrics</span>
        <span class="n">vmetrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_vmetrics</span><span class="p">()</span>
        <span class="n">set_vmetrics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">,</span> <span class="n">vmetrics</span><span class="p">[</span><span class="s">&#39;xheight&#39;</span><span class="p">],</span> <span class="n">vmetrics</span><span class="p">[</span><span class="s">&#39;capheight&#39;</span><span class="p">],</span> <span class="n">vmetrics</span><span class="p">[</span><span class="s">&#39;ascender&#39;</span><span class="p">],</span> <span class="n">vmetrics</span><span class="p">[</span><span class="s">&#39;descender&#39;</span><span class="p">],</span> <span class="n">vmetrics</span><span class="p">[</span><span class="s">&#39;emsquare&#39;</span><span class="p">])</span>
        <span class="c"># done</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;done.&#39;</span>
</div>
<div class="viewcode-block" id="hFont.make_guides"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.make_guides">[docs]</a>    <span class="k">def</span> <span class="nf">make_guides</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Build a guides dictionary from the project&#39;s ``vmetrics`` lib.&#39;&#39;&#39;</span>
        <span class="n">vmetrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_vmetrics</span><span class="p">()</span>
        <span class="n">guides</span> <span class="o">=</span> <span class="n">vmetrics</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="c"># separate guides into groups</span>
        <span class="n">guides_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;anchors&#39;</span> <span class="p">:</span> <span class="p">[</span> <span class="n">g</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">guides</span> <span class="k">if</span> <span class="s">&#39;anchors&#39;</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span> <span class="p">],</span>
            <span class="s">&#39;overshoots&#39;</span> <span class="p">:</span> <span class="p">[</span> <span class="n">g</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">guides</span> <span class="k">if</span> <span class="s">&#39;overshoot&#39;</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span> <span class="p">],</span>
            <span class="s">&#39;lc&#39;</span> <span class="p">:</span> <span class="p">[</span> <span class="n">g</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">guides</span> <span class="k">if</span> <span class="s">&#39;lc&#39;</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span> <span class="p">],</span>
            <span class="s">&#39;uc&#39;</span> <span class="p">:</span> <span class="p">[</span> <span class="n">g</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">guides</span> <span class="k">if</span> <span class="s">&#39;uc&#39;</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span> <span class="p">]</span> <span class="o">+</span> <span class="p">[</span> <span class="n">g</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">guides</span> <span class="k">if</span> <span class="s">&#39;capheight&#39;</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span> <span class="p">],</span>
        <span class="p">}</span>
        <span class="c"># compile guides dict from offsets</span>
        <span class="n">guides_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">guides_names</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">guides_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">guides_name</span> <span class="ow">in</span> <span class="n">guides_names</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span> <span class="s">&#39;anchors&#39;</span><span class="p">,</span> <span class="s">&#39;overshoots&#39;</span><span class="p">]</span> <span class="p">:</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="n">vmetrics</span><span class="p">[</span><span class="n">guides_name</span><span class="p">]</span>
                    <span class="n">pos_ref</span> <span class="o">=</span> <span class="n">guides_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">pos</span> <span class="o">+=</span> <span class="n">vmetrics</span><span class="p">[</span><span class="n">pos_ref</span><span class="p">]</span>
                    <span class="n">guides_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">guides_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">guides_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">guides_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmetrics</span><span class="p">[</span><span class="n">guides_name</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">guides_dict</span> <span class="o">=</span> <span class="n">guides_dict</span>
</div>
<div class="viewcode-block" id="hFont.draw_guides"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.draw_guides">[docs]</a>    <span class="k">def</span> <span class="nf">draw_guides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s">&#39;lowercase&#39;</span><span class="p">,</span> <span class="n">guides_group</span><span class="o">=</span><span class="s">&#39;overshoots&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Create guidelines using data from the project&#39;s ``vmetrics`` lib.&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;creating guidelines...&#39;</span><span class="p">,</span>
        <span class="c"># clear current guides</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_guides</span><span class="p">()</span>
        <span class="n">clear_guides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
        <span class="c"># create the guides</span>
        <span class="k">for</span> <span class="n">guide_name</span><span class="p">,</span> <span class="n">guide_pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">guides_dict</span><span class="p">[</span><span class="n">guides_group</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">case</span> <span class="o">==</span> <span class="s">&#39;lowercase&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">guide_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">guides_dict</span><span class="p">[</span><span class="s">&#39;uc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">addGuide</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">guide_pos</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">guide_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">guide_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">guides_dict</span><span class="p">[</span><span class="s">&#39;uc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">addGuide</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">guide_pos</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">guide_name</span><span class="p">)</span>
        <span class="c"># done</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;done.</span><span class="se">\n</span><span class="s">&#39;</span>
</div>
<div class="viewcode-block" id="hFont.clear_guides"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.clear_guides">[docs]</a>    <span class="k">def</span> <span class="nf">clear_guides</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Delete all global guides in the font.&#39;&#39;&#39;</span>
        <span class="n">clear_guides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.set_bluezones"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.set_bluezones">[docs]</a>    <span class="k">def</span> <span class="nf">set_bluezones</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Set the PostScript blue zones from the font&#39;s vertical metrics and guidelines dict.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_guides</span><span class="p">()</span>
        <span class="n">bluezones</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">bluezones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">guides_dict</span><span class="p">[</span><span class="s">&#39;overshoots&#39;</span><span class="p">][</span><span class="s">&#39;descender_overshoot&#39;</span><span class="p">])</span>
        <span class="n">bluezones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">descender</span><span class="p">)</span>
        <span class="n">bluezones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">guides_dict</span><span class="p">[</span><span class="s">&#39;overshoots&#39;</span><span class="p">][</span><span class="s">&#39;baseline_lc_overshoot&#39;</span><span class="p">])</span>
        <span class="n">bluezones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">bluezones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">guides_dict</span><span class="p">[</span><span class="s">&#39;overshoots&#39;</span><span class="p">][</span><span class="s">&#39;xheight_overshoot&#39;</span><span class="p">])</span>
        <span class="n">bluezones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">xHeight</span><span class="p">)</span>
        <span class="n">bluezones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">guides_dict</span><span class="p">[</span><span class="s">&#39;overshoots&#39;</span><span class="p">][</span><span class="s">&#39;capheight_overshoot&#39;</span><span class="p">])</span>
        <span class="n">bluezones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">capHeight</span><span class="p">)</span>
        <span class="n">bluezones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">guides_dict</span><span class="p">[</span><span class="s">&#39;overshoots&#39;</span><span class="p">][</span><span class="s">&#39;ascender_overshoot&#39;</span><span class="p">])</span>
        <span class="n">bluezones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">ascender</span><span class="p">)</span>
        <span class="n">bluezones</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptBlueValues</span> <span class="o">=</span> <span class="n">bluezones</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="hFont.clear_bluezones"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.clear_bluezones">[docs]</a>    <span class="k">def</span> <span class="nf">clear_bluezones</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptBlueValues</span> <span class="o">=</span><span class="p">[]</span>

    <span class="c"># font paths</span>
</div>
<div class="viewcode-block" id="hFont.otf_path"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.otf_path">[docs]</a>    <span class="k">def</span> <span class="nf">otf_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Return the default path for ``.otf`` font generation, in the project&#39;s ``_otfs/`` folder.&#39;&#39;&#39;</span>
        <span class="n">otf_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">+</span> <span class="s">&#39;.otf&#39;</span>
        <span class="k">if</span> <span class="n">test</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">otf_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">paths</span><span class="p">[</span><span class="s">&#39;otfs_test&#39;</span><span class="p">],</span> <span class="n">otf_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">folder</span><span class="p">:</span>
                <span class="n">otf_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">paths</span><span class="p">[</span><span class="s">&#39;otfs&#39;</span><span class="p">],</span> <span class="n">otf_file</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">otf_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">otf_file</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">otf_path</span>
</div>
<div class="viewcode-block" id="hFont.woff_path"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.woff_path">[docs]</a>    <span class="k">def</span> <span class="nf">woff_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Return the default path for ``.woff`` font generation, in the project&#39;s ``_woffs/`` folder.&#39;&#39;&#39;</span>
        <span class="n">woff_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">+</span> <span class="s">&#39;.woff&#39;</span>
        <span class="n">woff_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">paths</span><span class="p">[</span><span class="s">&#39;woffs&#39;</span><span class="p">],</span> <span class="n">woff_file</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">woff_path</span>
</div>
<div class="viewcode-block" id="hFont.ttx_path"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.ttx_path">[docs]</a>    <span class="k">def</span> <span class="nf">ttx_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Return the default path for ``.ttx`` generation, in the project&#39;s ``_ttx/`` folder.&#39;&#39;&#39;</span>
        <span class="n">ttx_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">+</span> <span class="s">&#39;.ttx&#39;</span>
        <span class="n">ttx_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">paths</span><span class="p">[</span><span class="s">&#39;ttx&#39;</span><span class="p">],</span> <span class="n">ttx_file</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ttx_path</span>

    <span class="c"># font generation</span>
</div>
<div class="viewcode-block" id="hFont.generate_otf"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.generate_otf">[docs]</a>    <span class="k">def</span> <span class="nf">generate_otf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Generate an ``.otf`` for the font using the given ``options``.&#39;&#39;&#39;</span>
        <span class="c"># get options</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">libs</span><span class="p">[</span><span class="s">&#39;project&#39;</span><span class="p">][</span><span class="s">&#39;generation&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="k">print</span> <span class="s">&#39;project </span><span class="si">%s</span><span class="s"> has no generation lib.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">name</span>
                <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s">&#39;decompose&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                    <span class="s">&#39;autohint&#39;</span> <span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
                    <span class="s">&#39;remove overlap&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                    <span class="s">&#39;release mode&#39;</span> <span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
                    <span class="s">&#39;test folder&#39;</span> <span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
                <span class="p">}</span>
        <span class="c"># get otf path</span>
        <span class="k">if</span> <span class="n">folder</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">_test</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s">&#39;test folder&#39;</span><span class="p">]</span>
            <span class="n">_otf_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">otf_path</span><span class="p">(</span><span class="n">test</span><span class="o">=</span><span class="n">_test</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_otf_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">otf_path</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="n">folder</span><span class="p">)</span>
        <span class="c"># print info</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;generating .otf for </span><span class="si">%s</span><span class="s">...</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_name</span><span class="p">()</span>
            <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">decompose: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">options</span><span class="p">[</span><span class="s">&#39;decompose&#39;</span><span class="p">]</span>
            <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">remove overlap: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">options</span><span class="p">[</span><span class="s">&#39;remove overlap&#39;</span><span class="p">]</span>
            <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">autohint: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">options</span><span class="p">[</span><span class="s">&#39;autohint&#39;</span><span class="p">]</span>
            <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">release mode: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">options</span><span class="p">[</span><span class="s">&#39;release mode&#39;</span><span class="p">]</span>
            <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">font path: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">_otf_path</span>
            <span class="k">print</span>
        <span class="c"># generate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ufo</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
                    <span class="n">_otf_path</span><span class="p">,</span> <span class="s">&#39;otf&#39;</span><span class="p">,</span>
                    <span class="n">decompose</span><span class="o">=</span><span class="n">options</span><span class="p">[</span><span class="s">&#39;decompose&#39;</span><span class="p">],</span>
                    <span class="n">autohint</span><span class="o">=</span><span class="n">options</span><span class="p">[</span><span class="s">&#39;autohint&#39;</span><span class="p">],</span>
                    <span class="n">checkOutlines</span><span class="o">=</span><span class="n">options</span><span class="p">[</span><span class="s">&#39;remove overlap&#39;</span><span class="p">],</span>
                    <span class="n">releaseMode</span><span class="o">=</span><span class="n">options</span><span class="p">[</span><span class="s">&#39;release mode&#39;</span><span class="p">])</span>
        <span class="c"># check if sucessfull</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">generation succesfull? </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">[</span><span class="s">&#39;No&#39;</span><span class="p">,</span> <span class="s">&#39;Yes&#39;</span><span class="p">][</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">_otf_path</span><span class="p">)]</span>
            <span class="k">print</span>
            <span class="k">print</span> <span class="s">&#39;...done.</span><span class="se">\n</span><span class="s">&#39;</span>
</div>
<div class="viewcode-block" id="hFont.generate_woff"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.generate_woff">[docs]</a>    <span class="k">def</span> <span class="nf">generate_woff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strip</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Generate a ``.woff`` font file from the available ``.otf`` font.&#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">hTools2_plus.extras.KLTF_WOFF</span> <span class="kn">import</span> <span class="n">compressFont</span>
            <span class="k">if</span> <span class="n">strip</span><span class="p">:</span>
                <span class="c"># save to ttx</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">generate_ttx</span><span class="p">()</span>    
                <span class="c"># strip names from ttx</span>
                <span class="n">ttx_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ttx_path</span><span class="p">()</span>
                <span class="n">strip_names</span><span class="p">(</span><span class="n">ttx_path</span><span class="p">)</span>
                <span class="c"># generate otf</span>
                <span class="n">otf_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">paths</span><span class="p">[</span><span class="s">&#39;woffs&#39;</span><span class="p">],</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">ttx_path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s">&#39;.otf&#39;</span><span class="p">)</span>
                <span class="n">ttx2otf</span><span class="p">(</span><span class="n">ttx_path</span><span class="p">,</span> <span class="n">otf_path</span><span class="p">)</span>
                <span class="c"># generate woff</span>
                <span class="n">compressFont</span><span class="p">(</span><span class="n">otf_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">woff_path</span><span class="p">())</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">otf_path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">compressFont</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">otf_path</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">woff_path</span><span class="p">())</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;KLTF WOFF module could not be imported.</span><span class="se">\n</span><span class="s"> &#39;</span>
</div>
<div class="viewcode-block" id="hFont.generate_ttx"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.generate_ttx">[docs]</a>    <span class="k">def</span> <span class="nf">generate_ttx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Generate a ``.ttx`` file from the available ``.otf`` font.&#39;&#39;&#39;</span>
        <span class="n">otf_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">otf_path</span><span class="p">()</span>
        <span class="n">ttx_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ttx_path</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">otf_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generate_otf</span><span class="p">()</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">TTFont</span><span class="p">(</span><span class="n">otf_path</span><span class="p">)</span>
        <span class="n">tt</span><span class="o">.</span><span class="n">saveXML</span><span class="p">(</span><span class="n">ttx_path</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="hFont.upload_woff"><a class="viewcode-back" href="../../../objects/hfont.html#hTools2.objects.hfont.hFont.upload_woff">[docs]</a>    <span class="k">def</span> <span class="nf">upload_woff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Upload the font&#39;s ``.woff`` file to the project&#39;s folder in the FTP server.&#39;&#39;&#39;</span>
        <span class="n">woff_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">woff_path</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">woff_path</span><span class="p">):</span>
            <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hDict</span><span class="p">[</span><span class="s">&#39;ftp&#39;</span><span class="p">][</span><span class="s">&#39;url&#39;</span><span class="p">]</span>
            <span class="n">login</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hDict</span><span class="p">[</span><span class="s">&#39;ftp&#39;</span><span class="p">][</span><span class="s">&#39;login&#39;</span><span class="p">]</span>
            <span class="n">password</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hDict</span><span class="p">[</span><span class="s">&#39;ftp&#39;</span><span class="p">][</span><span class="s">&#39;password&#39;</span><span class="p">]</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">ftp_path</span><span class="p">()</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">connect_to_server</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">login</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">upload_file</span><span class="p">(</span><span class="n">woff_path</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
            <span class="n">F</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;woff </span><span class="si">%s</span><span class="s"> does not exist.&#39;</span> <span class="o">%</span> <span class="n">woff_path</span>
</pre></div></div></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">hTools2</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../hTools2.html" >hTools2</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Gustavo Ferreira.
      Last updated on Feb 28, 2014.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b3.
    </div>
  </body>
</html>